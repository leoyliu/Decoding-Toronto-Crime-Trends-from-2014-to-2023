---
title: "Shifting Shadows of the Six: Decoding Toronto's Crime Trends from 2014 to 2023"
author: 
  - Yuanyi (Leo) Liu
thanks: "Code and data are available at: https://github.com/leoyliu/STA302-Paper-1."
date: today
date-format: long
abstract: "In this study, we conducted a comprehensive analysis of crime trends in Toronto, utilizing a dataset detailing various criminal activities from 2014 to 2023. Our investigation focused on the evolution of different types of crimes, with a specific emphasis on contrasting violent crimes, such as assault and robbery, against non-violent offenses like theft. The findings reveal significant patterns in both categories, highlighting an evolving landscape of criminal behavior in Toronto. This research is crucial as it sheds light on the changing dynamics of urban crime, providing valuable insights for policymakers, law enforcement agencies, and community leaders in developing targeted strategies for crime prevention and enhancing public safety in metropolitan areas."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# install.packages("knitr")
# install.packages("opendatatoronto")
# install.packages("tidyverse")
# install.packages("here")
# install.packages("tidyr")
# install.packages("dplyr")
# install.packages("kableExtra")

library(knitr)
library(opendatatoronto)
library(tidyverse)
library(here)
library(tidyr)
library(dplyr)
library(kableExtra)
library(janitor)
```


# Introduction {#sec-intro}

Urban crime, a multifaceted issue impacting communities worldwide, poses significant challenges to public safety and social stability. Toronto, Canada's largest city, is no exception. The broader context of urban crime in Toronto is critical in understanding its impact on the city's development, public perception, and policy formulation. Despite extensive research in urban criminology, there remains a gap in comprehensively understanding how different types of crimes, especially violent and non-violent, have evolved over recent years in Toronto. This gap is crucial for developing effective crime prevention strategies and enhancing public safety.

This paper presents a detailed analysis of crime trends in Toronto from 2014 to 2023. The study focuses on two primary crime categories: violent crimes, such as assault and robbery, and non-violent crimes, including theft and fraud. By leveraging a comprehensive dataset, we delve into how these crime categories have changed over time and their implications for urban safety and policing strategies. The analysis not only uncovers patterns and trends in these crime categories but also offers a comparative perspective, highlighting the distinct trajectories of violent and non-violent crimes.

The findings of this study are significant for several reasons. First, they provide a nuanced understanding of the crime dynamics in a major urban center, offering insights that are vital for policymakers, law enforcement, and community leaders. The patterns observed suggest shifts in criminal behavior and possibly reflect broader social and economic changes in the city. Second, the comparative analysis between violent and non-violent crimes offers a unique perspective on the nature of criminal activities, contributing to a more targeted approach in crime prevention and community safety initiatives.

The paper is structured to facilitate a comprehensive understanding of the study and its implications. Following this introduction @sec-intro, the second section presents the data @sec-data, detailing the data sources, analytical techniques, and the rationale behind the chosen methods. The third section discusses the results @sec-result, elaborating on the observed trends and patterns in crime data. The fourth section provides an in-depth discussion @sec-discussion of these findings, exploring potential factors influencing these trends, drawing connections to broader urban issues, and suggestions for future research in this area.


# Data {#sec-data}

## Overview
This section @sec-data aims to offer an insightful understanding of the dataset utilized in our analysis, focusing on its content, origin, and the methods applied for data manipulation and visualization.

## Source of the Data
The dataset comprises crime statistics in Toronto, spanning from 2014 to 2023. The dataset analyzed in this report was obtained in csv format from the City of Toronto Open Data Portal[@citedata] using the R package `opendatatoronto`[@citeopendatapkg]. The dataset was last updated on January 14th, 2024. This dataset is publicly available and is often used for academic and policy research due to its reliability and comprehensive coverage.

## Alternative Dataset Consideration
Although alternative datasets were considered, this specific dataset was selected for its detailed year-wise breakdown and the diversity of crime types it encompasses. Other datasets either lacked the temporal detail or the variety of crime categories present in our chosen dataset.

## Data Manipulation and Cleaning in R [@citeR]
The data was processed and cleaned using R[@citeR], a powerful statistical programming language. Key operations included:

* **Data Cleaning:** Addressing missing values, standardizing formats, and filtering out irrelevant variables using the `tidyverse`[@citetidyverse] package(e.g., removing rate-based columns and NAs).

* **Data Transformation:** Converting the dataset from a wide format to a long format for easier manipulation using the `tidyr`[@citetidyr] package.

* **Aggregation:** Summarizing the data by year and crime type using the `dplyr`[@citedplyr] package.

* **Data Visualization:** For visual representation, `ggplot2` [@citeggplot], a versatile package in R for data visualization, was employed. It was used to create comprehensive line plots depicting the trends of various crime categories over the years.

* **Paper Generation:** The packages `knitr` [@citeknitr] is used to generate the R markdown report.

## Variables Explanation
The dataset includes various crime categories, such as assault, theft, and other types, with each variable representing the annual count of reported cases for each crime type. This longitudinal data provides a detailed view of the crime trends in Toronto over a decade. 

```{r}
#| label: tabledatasummary
#| echo: false

# Read the data
crime_data <- read.csv(here("inputs/data/cleaned_toronto_crime_rates.csv"))

# Remove unnecessary columns for this plot
crime_data <- crime_data %>%
  select(-grep("RATE", names(crime_data)))

# Gather the data to a long format
crime_data_long <- crime_data %>%
  gather(key = "Crime_Year", value = "Count", -AREA_NAME)

# Extract year and crime type from the 'Crime_Year' column
crime_data_long <- crime_data_long %>%
  separate(Crime_Year, into = c("Crime_Type", "Year"), sep = "_") %>%
  mutate(Year = as.numeric(Year))

# Aggregate the data by year and crime type
crime_data_summary <- crime_data_long %>%
  group_by(Crime_Type, Year) %>%
  summarise(Total = sum(Count, na.rm = TRUE), .groups = "drop")

# Creating the summary table
summary_table <- crime_data_summary %>%
  group_by(Crime_Type, Year) %>%
  summarise(Total_Cases = sum(Total, na.rm = TRUE), .groups = "drop") %>%
  spread(key = Year, value = Total_Cases)

# Define a mapping for crime types
readable_crime_types <- c('ASSAULT' = 'Assault',
                          'AUTOTHEFT' = 'Auto Theft',
                          'BIKETHEFT' = 'Bike Theft',
                          'BREAKENTER' = 'Break and Enter',
                          'HOMICIDE' = 'Homicide',
                          'ROBBERY' = 'Robbery',
                          'SHOOTING' = 'Shooting Incidents',
                          'THEFTFROMMV' = 'Theft from Motor Vehicles',
                          'THEFTOVER' = 'Major Theft')

# Update the Crime_Type column
summary_table$Crime_Type <- readable_crime_types[summary_table$Crime_Type]

# Make a beautiful table
summary_table %>%
  slice(1:10) %>%
  kable(
    caption = "Crime Incidents Summary by Year",
    col.names = c("Crime Type", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023"),
    digits = 1,
    booktabs = TRUE,
    linesep = "",
    align = c("l", "l", "c", "c", "r", "r"),
    format.args = list(big.mark = ",")) %>%
    kable_styling(latex_options = "HOLD_position", font_size = 10, position = "center")
```
Table 1 organizes data into a clear format where each row indicates a specific type of crime. The columns are segmented by year, spanning from 2014 to 2023. Each cell within the table provides a count of the incidents reported for that particular crime in the corresponding year.

Then, we want to categorize our data into one of two groups: 'Violent' or 'Non-Violent'. This categorization was based on the nature of the crime. For example, crimes like 'ASSAULT', 'HOMICIDE', etc., were categorized as 'Violent', while others like 'THEFT', were categorized as 'Non-Violent'. After categorization, the dataset was aggregated based on these two new categories. This involved summing up the incident counts for each category (Violent and Non-Violent) for every year.

```{r}
#| label: combineddatasummary
#| echo: false
summary_table$Category <- ifelse(summary_table$Crime_Type %in% c("Assault", "Break and Enter", "Homicide", "Robbery", "Shooting Incidents"), "Violent", "Non-Violent")

# Group data by the new Category and sum the cases for each year
two_types_crime <- summary_table %>%
  group_by(Category) %>%
  summarise(across(`2014`:`2023`, ~sum(.x, na.rm = TRUE)))

# Make a beautiful table
two_types_crime %>%
  slice(1:10) %>%
  kable(
    caption = "Crime Incidents Summary by Year",
    col.names = c("Crime Type", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023"),
    digits = 1,
    booktabs = TRUE,
    linesep = "",
    align = c("l", "l", "c", "c", "r", "r"),
    format.args = list(big.mark = ",")) %>%
    kable_styling(latex_options = "HOLD_position", font_size = 10, position = "center")
```

Table 2 organized view of crime statistics over a range of years, specifically differentiated into two main categories: 'Violent' and 'Non-Violent' crimes. Each row in the table represents one of these two categories. The columns of the table are divided by year, ranging from 2014 to 2023. Under each year's column, the table displays the total number of reported incidents for each crime category. For example, under the column for 2014, you will find the total number of violent crimes reported in that year followed by the total number of non-violent crimes for the same year.

## Summary Statistics and Relationship Analysis
The dataset was summarized using basic statistical measures (mean, median, standard deviation) to provide an overview of each crime category. Further, the relationships between different crime types were explored to understand correlated trends, if any.

\newpage

# Results {#sec-result}

```{r}
#| label: fig-trends-in-crime
#| fig-cap: Trends in Crime Cases in Toronto (2014-2023)
#| echo: false

# Plotting all crime types in one graph
ggplot(crime_data_summary, aes(x = Year, y = Total, color = Crime_Type)) +
  geom_line() +
  labs(title = "Evolution of Various Crimes in Toronto", x = "Year", y = "Total Count") +
  theme_minimal() +
  theme(legend.position="bottom") +
  guides(color = guide_legend(title = "Crime Type"))
```
@fig-trends-in-crime reveals distinct trends for various crime types in Toronto over the years. We notice that assault crimes have been on the rise in recent years, this could signal a growing concern in public safety and might prompt law enforcement to investigate the underlying causes, such as increased urbanization, changes in population density, or other socio-economic factors. Conversely, there is a noticeable decline in theft-related crimes, it could reflect the success of recent crime prevention initiatives, improved security measures, or increased public awareness.

```{r}
#| label: fig-trends-in-two-types-crime
#| fig-cap: Comparative Trend Analysis of Violent and Non-Violent Crime Cases from 2014 to 2023
#| echo: false

# Ensure the data is ungrouped
two_types_crime <- ungroup(two_types_crime)

# Pivot the data to long format for plotting
# Explicitly select the year columns to avoid issues with hidden grouping columns
long_data <- two_types_crime %>%
  select(Category, `2014`:`2023`) %>%
  pivot_longer(cols = -Category, names_to = "Year", values_to = "Cases")

# Create the plot
crime_plot <- ggplot(long_data, aes(x = Year, y = Cases, group = Category, color = Category)) +
  geom_line(linewidth = 1) + # Use linewidth instead of size
  geom_point(size = 3) + # Point size
  theme_minimal() + # Minimal theme
  labs(title = "Evolution of Violent and Non-Violent Crimes Over the Years",
       x = "Year",
       y = "Number of Cases") +
  scale_color_manual(values = c("Violent" = "red", "Non-Violent" = "blue")) +
  theme(
    plot.title = element_text(hjust = 0.5), # Center the plot title
    legend.title = element_blank(), # Remove the legend title
    axis.text.x = element_text(angle = 45, hjust = 1) # Angle the x-axis text for readability
  )

# Print the plot
print(crime_plot)
```

@fig-trends-in-two-types-crime compares the number of cases reported for violent and non-violent crimes from 2014 to 2023. The x-axis represents the years, and the y-axis indicates the number of cases.

The red line represents violent crimes, and the blue line represents non-violent crimes. The plot shows distinct trends for both categories over the specified time frame.

* **Violent Crimes (Red Line):** There is an overall increasing trend in the number of violent crime cases over the years. There are some fluctuations, with a noticeable dip occurring in one of the years, but the general direction is upwards, especially towards the end of the period, indicating a rise in violent crimes or an increase in reporting.

* **Non-Violent Crimes (Blue Line):** The trend in non-violent crime cases shows some variability but does not have as clear an increasing pattern as violent crimes. There are years where the rate has increased or decreased, but the last year shows a notable increase, suggesting a possible upward trend at the end of the period.

Overall, the graph indicates that while both violent and non-violent crimes have seen rises and falls, the increase in violent crimes towards the later years is more pronounced. This could reflect changes in societal conditions, law enforcement practices, or reporting mechanisms.

# Discussion {#sec-discussion}

Based on the analysis of the provided dataset and the visual representation of crime trends in Toronto over the years, several key results can be summarized:

## Variation in Crime Trends: {#sec-first-point}

The dataset reveals distinct trends for different types of crimes in Toronto. Some crime categories exhibit an upward trend, indicating an increase in incidents over the years, while others show a downward trend, suggesting a decrease in occurrences. This variation highlights the complexity of crime dynamics in an urban setting.

## Potential Factors Influencing Trends: {#sec-second-point}

The observed trends in crime rates could be influenced by a multitude of factors. These include socio-economic changes, urban development, law enforcement strategies, policy reforms, and technological advancements in crime reporting. For example, an increase in certain types of crimes might be linked to economic downturns, demographic shifts, or changes in urban density, while a decrease could reflect effective policing strategies or community intervention programs.

The findings of this analysis are particularly relevant for policymakers and law enforcement agencies. Understanding these trends is crucial for developing targeted strategies to address and prevent crime effectively, thereby enhancing public safety and community well-being in Toronto.

## Weaknesses and next steps

While the visual analysis provides a high-level overview of crime trends in Toronto, it's essential to conduct more detailed investigations to understand the underlying causes of these trends. This includes examining subcategories of crimes, focusing on specific geographic areas within the city, and considering other relevant data sources.

\newpage

# References

